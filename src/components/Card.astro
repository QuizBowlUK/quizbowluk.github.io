---
import type { ImageMetadata } from "astro";
import { Image } from "astro:assets";
import type { CollectionEntry } from "astro:content";

export interface Props {
  post: CollectionEntry<"blog">;
}

const { post } = Astro.props;
const { title, date, description, image } = post.data;

const teaserPath = `/src/assets/blog/${image.teaser.path}`;

const images = import.meta.glob<{ default: ImageMetadata }>(
  "/src/assets/blog/**/*.{jpeg,jpg,png,gif,webp}",
);
if (!images[teaserPath]) {
  throw new Error(
    `"${teaserPath}" does not exist in glob: "src/assets/blog/*.{jpeg,jpg,png,gif,webp}"`,
  );
}
---

<div class="h-100 overflow-hidden rounded-lg bg-white shadow-md">
  <div class="aspect-[16/9]">
    <Image
      src={images[teaserPath]()}
      alt={image.teaser.alt}
      class="h-full w-full object-cover object-center"
    />
  </div>
  <div class="p-4">
    <div class="-mb-3 text-sm text-gray-500">
      {
        date.toLocaleDateString("en-GB", {
          day: "numeric",
          month: "long",
          year: "numeric",
        })
      }
    </div>
    <h2 class="text-xl leading-tight font-bold">{title}</h2>
    <p class="text-md line-clamp-4 text-gray-700">{description}</p>
  </div>
</div>
